<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>強力パスワード生成 | UniTools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col">

    <header class="p-4 bg-white shadow-sm">
        <a href="../index.html" class="text-blue-600 font-bold hover:underline">
            <i class="fa-solid fa-arrow-left"></i> TOPに戻る
        </a>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8 max-w-md">
        <div class="text-center mb-8">
            <div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-3xl mx-auto mb-4">
                <i class="fa-solid fa-key"></i>
            </div>
            <h1 class="text-2xl font-bold">パスワード生成</h1>
            <p class="text-gray-500 text-sm">安全なパスワードを瞬時に作成</p>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100 mb-6">
            <input type="text" id="result" class="w-full text-2xl font-mono text-center bg-gray-50 border border-gray-300 rounded-lg py-4 px-2 mb-4 focus:outline-none focus:border-blue-500" readonly placeholder="ここに表示">
            
            <button id="copyBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition flex items-center justify-center gap-2">
                <i class="fa-regular fa-copy"></i> コピーする
            </button>
            <p id="msg" class="text-center text-green-600 text-sm h-5 mt-2 font-bold"></p>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
            <label class="block text-sm font-bold mb-2">文字数: <span id="lenVal">12</span>文字</label>
            <input type="range" id="length" min="4" max="32" value="12" class="w-full mb-6 accent-blue-600">

            <div class="space-y-3">
                <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox" id="upper" checked class="w-5 h-5 text-blue-600 rounded">
                    <span>英語 大文字 (A-Z)</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox" id="lower" checked class="w-5 h-5 text-blue-600 rounded">
                    <span>英語 小文字 (a-z)</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox" id="numbers" checked class="w-5 h-5 text-blue-600 rounded">
                    <span>数字 (0-9)</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox" id="symbols" class="w-5 h-5 text-blue-600 rounded">
                    <span>記号 (!@#$%)</span>
                </label>
            </div>

            <button id="genBtn" class="w-full mt-8 bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 rounded-lg transition">
                <i class="fa-solid fa-rotate"></i> 別のを作る
            </button>
        </div>
    </main>

    <script>
        const resultEl = document.getElementById('result');
        const lengthEl = document.getElementById('length');
        const lenValEl = document.getElementById('lenVal');
        const copyBtn = document.getElementById('copyBtn');
        const genBtn = document.getElementById('genBtn');
        const msg = document.getElementById('msg');

        const upperEl = document.getElementById('upper');
        const lowerEl = document.getElementById('lower');
        const numbersEl = document.getElementById('numbers');
        const symbolsEl = document.getElementById('symbols');

        const randomFunc = {
            lower: () => String.fromCharCode(Math.floor(Math.random() * 26) + 97),
            upper: () => String.fromCharCode(Math.floor(Math.random() * 26) + 65),
            number: () => String.fromCharCode(Math.floor(Math.random() * 10) + 48),
            symbol: () => {
                const symbols = '!@#$%^&*(){}[]=<>/,.';
                return symbols[Math.floor(Math.random() * symbols.length)];
            }
        };

        lengthEl.addEventListener('input', (e) => {
            lenValEl.innerText = e.target.value;
            generatePassword();
        });

        genBtn.addEventListener('click', generatePassword);

        copyBtn.addEventListener('click', () => {
            const textarea = document.createElement('textarea');
            const password = resultEl.value;
            if(!password) return;
            textarea.value = password;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            textarea.remove();
            msg.innerText = 'コピーしました！';
            setTimeout(() => msg.innerText = '', 2000);
        });

        // 変更があったら再生成
        [upperEl, lowerEl, numbersEl, symbolsEl].forEach(el => {
            el.addEventListener('change', generatePassword);
        });

        function generatePassword() {
            const length = +lengthEl.value;
            const hasLower = lowerEl.checked;
            const hasUpper = upperEl.checked;
            const hasNumber = numbersEl.checked;
            const hasSymbol = symbolsEl.checked;

            let generatedPassword = '';
            const typesCount = hasLower + hasUpper + hasNumber + hasSymbol;
            const typesArr = [{lower: hasLower}, {upper: hasUpper}, {number: hasNumber}, {symbol: hasSymbol}].filter(item => Object.values(item)[0]);

            if(typesCount === 0) {
                resultEl.value = '';
                return;
            }

            for(let i = 0; i < length; i += typesCount) {
                typesArr.forEach(type => {
                    const funcName = Object.keys(type)[0];
                    generatedPassword += randomFunc[funcName]();
                });
            }

            const finalPassword = generatedPassword.slice(0, length);
            resultEl.value = finalPassword;
        }

        generatePassword(); // 初回実行
    </script>
</body>
</html>